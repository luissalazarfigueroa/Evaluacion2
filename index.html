<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>ICVU & PSU</title>
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.2/css/bootstrap.min.css" integrity="sha384-Smlep5jCw/wG7hdkwQ/Z5nLIefveQRIY9nfy6xoR1uRYBtpZgI6339F5dgvm/e9B" crossorigin="anonymous">
    <link href="grayscale.css" rel="stylesheet">
  </head>

  <body id="page-top">

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
      <div class="container">
        <a class="navbar-brand js-scroll-trigger" href="#page-top">ICVU & PSU</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
          Menu
          <i class="fas fa-bars"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#about">About</a>
            </li>
            <li class="nav-item">
              <a class="nav-link js-scroll-trigger" href="#visualizations">Visualizations</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <!-- Header -->
    <header class="masthead">
      <div class="container d-flex h-100 align-items-center">
        <div class="mx-auto text-center">
          <h1 class="mx-auto my-0 text-uppercase">ICVU & PSU</h1>
          <h2 class="text-white-50 mx-auto mt-2 mb-5">Relación entre la calidad de vida y el rendimiento PSU</h2>
          <a href="#about" class="btn btn-primary js-scroll-trigger">Iniciar Recorrido</a>
        </div>
      </div>
    </header>

    <!-- About Section -->
    <section id="about" class="about-section text-center">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 mx-auto">
            <h2 class="text-white mb-4">Calidad de Vida y su influencia en la PSU</h2>
            <p class="text-white-50">Comparación entre el indice de calidad de vida urbana, el resultado promedio PSU, el número de estudiantes matriculados y el número de estudiantes que rinde la PSU en las comunas de la Región Metropolitana</p>
          </div>
        </div>
        <img src="img/pencil.png" class="img-fluid" alt="">
      </div>
    </section>

    <!-- Visualizations Section -->
    <section id="visualizations" class="projects-section bg-light">
      <div class="container">

        <!-- Featured Project Row -->
        <div class="row align-items-center no-gutters mb-4 mb-lg-5">
          <div class="col-xl-8 col-lg-7" id="principal"></div>
          <div class="col-xl-4 col-lg-5">
            <div class="featured-text text-center text-lg-left">
              <h4>Calidad de Vida y Puntaje</h4>
              <p class="text-black-50 mb-0"> Visualización de los resultados PSU promedio por comuna de la región metropolitana, representado en la longitud de las barras, en relación al índice de calidad de vida urbana, representado en el color de las barras,  verde mejor calidad de vida y rojo menor. Así mismo se representa el indice de condiciones socioculturales de cada comuna en la longitud de las barras menores.  </p>

            </div>
          </div>
        </div>

        <!-- Project One Row -->
        <div class="row justify-content-center no-gutters mb-5 mb-lg-0">
          <div class="col-lg-6" id="secundario_left"></div>
          <div class="col-lg-6">
            <div class="bg-black text-center h-100 project">
              <div class="d-flex h-100">
                <div class="project-text w-100 my-auto text-center text-lg-left">
                  <h4 class="text-white">Rendición de PSU</h4>
                  <p class="mb-0 text-white-50">Número de estudiantes que asisten a rendir la psu y número total de estudiantes matriculados en las comunas con mayor y menor índice de calidad de vida urbana. </p>
                  <hr class="d-none d-lg-block mb-0 ml-0">
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Project Two Row -->
        <div class="row justify-content-center no-gutters">
          <div class="col-lg-6" id="secundario_right"></div>
          <div class="col-lg-6 order-lg-first">
            <div class="bg-black text-center h-100 project">
              <div class="d-flex h-100">
                <div class="project-text w-100 my-auto text-center text-lg-right">
                  <h4 class="text-white">Rendición según ICVU</h4>
                  <p class="mb-0 text-white-50">Rendición total de PSU por cada una de las tres clasificaciones simples del ICVU; Rango Superior, Rango Promedio y Rango Inferior</p>
                  <hr class="d-none d-lg-block mb-0 mr-0">
                </div>
              </div>
            </div>
          </div>
        </div>

      </div><!--/container-->
    </section><!--/visualizations-->

    <footer class="bg-black small text-center text-white-50">
      <div class="container">
      Fuentes: <a href="https://es.datachile.io/">datachile</a> & <a href="http://www.cchc.cl/uploads/comunicacion/archivos/20180508_ICVU_2018_-_Versi%C3%B3n_Definitiva.pdf">Índice de calidad de vida urbana en Chile</a>
      </div>
    </footer>

    <!-- Bootstrap core JavaScript -->
    <script src="vendor/jquery/jquery.min.js"></script>
    <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Plugin JavaScript -->
    <script src="vendor/font-awesome/js/all.js"></script>
    <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

    <!-- Custom scripts for this template -->
    <script src="js/grayscale.min.js"></script>

    <!-- Data Drive Document -->
    <script src="https://d3js.org/d3.v5.min.js"></script>

    <!--primera visualización-->
    <script>
       var w = 500, f = 0.5, h = 25;

       d3.csv("https://raw.githubusercontent.com/luissalazarfigueroa/Evaluacion2/gh-pages/psucalidaddevida.csv").then(function(data) {

         console.log(data);

         var viz = d3.select("#principal")
           .append("svg")
           .attr("width", w)
           .attr("height", h * data.length)
           .style("background","#FFFFF");

         var bar = viz.selectAll("g")
           .data(data)
           .enter()
           .append("g")
           .attr("transform", function(d, i) { return "translate(0," + i * h + ")"; });

           bar.append("rect")
             .attr("width", function(d) { return d.puntajepsu * f; })
             .attr("fill",function(d) {
                  return "rgb(" + (200 - d.calidaddevida) + ", " + (d.calidaddevida / 100 * 255  + 20) + ", 0 )";
             })
             .attr("height", h - 5);

             bar.append("rect")
               .attr("width", function(d) { return d.sociocultural * 2; })
               .attr("fill","rgba(0, 0, 250, 0.4)")
               .attr("height", h - 5);

           bar.append("text")
             .attr("x", function(d) { return (d.puntajepsu * f)+5; })
             .attr("y", h / 2)
             .text(function(d) { return d.comuna; })
             .attr("fill","#445566")
             .attr("font-size","12")
             .attr("font-weight","bold")

           bar.append("text")
             .attr("x", function(d) { return (d.puntajepsu * f)-10; })
             .attr("y", h / 2)
             .text(function(d) { return (d.puntajepsu); })
             .attr("fill","#FFFFFF")
             .attr("font-size","12")
             .attr("text-anchor","end")

             bar.append("text")
               .attr("x", function(d) { return (d.puntajepsu * f)-120; })
               .attr("y", h / 2)
               .text(function(d) { return Math.round(d.calidaddevida); })
               .attr("fill","rgba(255,255,255,0.5)")
               .attr("font-size","12")
               .attr("text-anchor","end")
               bar.append("text")
                 .attr("x","5%")
                 .attr("y", h / 2)
                 .text(function(d) { return Math.round(d.sociocultural); })
                 .attr("fill","rgba(255,255,255,0.5)")
                 .attr("font-size","12")

       })
    </script>



    <!--segunda visualización-->

    <script>
    // vamos a buscar otra data
    d3.csv("https://raw.githubusercontent.com/luissalazarfigueroa/pruebacsv/gh-pages/calidaddevidapsu2.csv").then(function(data) {
      console.log(data);

       var w = 980, h = 200, f = 130;

        var svg = d3.select("#secundario_left")
        .append("svg")
         .attr("width", "100%")
         .attr("height", data.length*h)
         .style("background","whitesmoke");

        var g = svg.selectAll("g")
          .data(data)
          .enter()
          .append("g")

        g.append("circle")
          .attr("cy", function(d, i) {
            return (i+1) * h*5/(data.length); })
          .attr("cx", "50%")
          .attr("r", function(d) { return d.rindieron/f; })
          .attr("fill",function(d) {
               return "rgb(" + (200 - d.calidaddevida) + ", " + (d.calidaddevida / 100 * 255  + 20) + ", 0 )";})

        g.append("circle")
                 .attr("cy", function(d, i) {
                   return (i+1) * h*5/(data.length); })
                 .attr("cx", "50%")
                 .attr("r", function(d) { return d.matriculados/f; })
                 .attr("fill",function(d) {
                      return "rgba(" + (200 - d.calidaddevida) + ", " + (d.calidaddevida / 100 * 255  + 20) + ", 0, 0.1)";})

        g.append("text")
              .attr("x", "50%")
              .attr("y", function(d, i) {
              return (i+1) * h*5/(data.length); })
              .text(function(d) { return (d.rindieron); })
              .attr("fill","white")
              .attr("font-size","12")
              .attr("text-anchor","middle")
              .attr("font-weight","bold")

              g.append("text")
                    .attr("x", "20%")
                    .attr("y", function(d, i) {
                    return (i+1) * h*5/(data.length); })
                    .text(function(d) { return (d.comuna); })
                    .attr("fill","black")
                    .attr("font-size","12")
                    .attr("text-anchor","middle")

                                  g.append("text")
                                        .attr("x", "80%")
                                        .attr("y", function(d, i) {
                                        return (i+1) * h*5/(data.length); })
                                        .text(function(d) { return ("de "+ d.matriculados + " " + "matriculados"); })
                                        .attr("fill","black")
                                        .attr("font-size","12")
                                        .attr("text-anchor","middle")


        //dentro del mismo grupo, agregar texto para la data


    });
    </script>

    <!--tercera visualización-->

    <script>
    var l = 500, radius = 200;
d3.csv("https://raw.githubusercontent.com/luissalazarfigueroa/Evaluacion2/gh-pages/psucalidaddevida.csv").then(function(data) {
  console.log(data);

    var calculo = [
       {name: 'Índice Alto', count: 38514, color: '#72B62B'},
       {name: 'Índice Promedio', count: 67494, color: '#F4E558'},
       {name: 'Índice Bajo', count: 98898, color: '#DD3E3E'},

     ];

     var arc = d3.arc().outerRadius(radius - 50).innerRadius(100);

     var pie = d3.pie().sort(null).value(function(d) { return d.count; });

     var svg = d3.select('#secundario_right').append("svg")
       .attr("width", "100%")
       .attr("height", l)
       .style("background","#EEEEEE")
       .append("g")
       .attr("transform", "translate(" + 280 + "," + l/2 + ")");

     var g = svg.selectAll(".arc")
       .data(pie(calculo))
       .enter().append("g");

     g.append("path")
       .attr("d", arc)
       .style("fill", function(d,i) { return d.data.color; });

     g.append("text")
       .attr("transform", function(d) { return "translate(" + arc.centroid(d) + ")"; })
       .style("text-anchor", "middle")
       .text(function(d) { return d.data.count+ " estudiantes"; })
       .attr("fill","black")
       .attr("font-weight","bold")
       .style("font-size","12px")




});
    </script>

  </body>
</html>
